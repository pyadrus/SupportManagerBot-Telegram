# Документация по работе с проектом

## Общая информация

Данный проект представляет собой Telegram-бота, предназначенного для взаимодействия пользователей, операторов и администраторов. Бот интегрирован с базой данных src/core/database/database.db и поддерживает управление ролями, обработку запросов пользователей и консультирование.

---
## Роли в системе

В проекте предусмотрены следующие роли:

- **Администратор**
    - Ответственен за курирование работы операторов.
    - Пример: @PythonDEV1
- **Оператор**
    - Занимается консультированием пользователей по их вопросам.
    - Пример: @OlgaSmir123
- **Пользователь**
    - Использует бота как консультанта для постановки вопросов и получения помощи.
    - Пример: @PyAdminRU

---
## Функционал ролей

### Пользователь

#### Описание

Пользователь взаимодействует с ботом для получения консультаций. Процесс работы включает заполнение данных и постановку вопросов.

#### Рабочий процесс

1. **Запуск бота**:
    - Пользователь вызывает команду /start.
    - Бот записывает данные в таблицу register_user базы данных src/core/database/database.db.
    - Изначально пользователю присваивается статус user.
2. **Заполнение данных**:
    - Пользователь вводит имя, фамилию, телефон и формулирует вопрос.
    - Данные сохраняются в следующем формате:
        ```python
        user_data = {
            "id": message.from_user.id,  # ID пользователя
            "first_name": message.from_user.first_name,  # Имя пользователя
            "last_name": message.from_user.last_name,  # Фамилия пользователя
            "username_tg": message.from_user.username,  # Username пользователя
            "lang": 'ru',  # Язык пользователя (с проверкой наличия в базе данных)
            "status": 'user',  # Статус пользователя Telegram бота
            "username": "",  # Имя пользователя (если применимо)
            "password": "",  # Пароль (если применимо)
            "date": message.date,  # Дата и время регистрации
        }
        ```
    - По умолчанию язык установлен как русский (ru). При выборе другого языка (например, через меню), значение lang в таблице обновляется.
3. **Подтверждение данных**:
    - Пользователь подтверждает введённые данные.
    - После подтверждения бот отправляет сообщение операторам в личку Telegram бота. Операторы определяются из таблицы register_user по значению status = 'operator'.

#### Изменение статуса
- Администратор может изменить статус пользователя на admin или operator через интерфейс бота или вручную в базе данных.

---
### Оператор

#### Описание

Оператор отвечает за консультирование пользователей, обрабатывая их вопросы.
#### Рабочий процесс
- Получает уведомления от бота в личном чате, содержащие данные пользователя (имя, фамилия, телефон, вопрос).
- Общается с пользователем напрямую или через бота для решения вопроса.
- Обновляет статус заявки (см. ниже).
---

### Администратор

#### Описание

Администратор управляет работой операторов и контролирует процесс консультирования.

#### Рабочий процесс
- Мониторит активность операторов.
- Изменяет статусы пользователей в таблице register_user (например, с user на admin или operator).
- Просматривает статистику обращений и статусы заявок.

---
## Статусы заявок

Обращения пользователей имеют следующие статусы:
- **В ожидании**: Заявка только создана и ожидает обработки оператором.
- **В обработке**: Оператор начал работу над заявкой.
- **Закрыто**: Заявка решена, и общение завершено.

Статусы хранятся в базе данных и могут быть обновлены оператором или администратором.

---
## Технические детали

### База данных

- **Файл**: src/core/database/database.db
- **Таблица**: register_user
    - Содержит данные пользователей, включая id, first_name, last_name, username_tg, lang, status, и date.
    - Операторы определяются по значению status = 'operator'.

### Язык

- По умолчанию язык установлен как ru (русский).
- Пользователь может выбрать другой язык, и поле lang в таблице обновляется соответствующим образом.

### Обработка запросов

- При подтверждении данных бот отправляет уведомления операторам через Telegram API.
- Данные для уведомлений берутся из таблицы register_user.

---
## Пример использования

1. Пользователь @PyAdminRU вызывает /start и вводит:
    - Имя: Александр
    - Фамилия: Иванов
    - Телефон: +79991234567
    - Вопрос: Как оформить заказ?
    - Подтверждает данные.
2. Бот записывает данные в register_user с status = 'user' и отправляет сообщение оператору @OlgaSmir123.
3. Оператор @OlgaSmir123 отвечает пользователю, обновляя статус заявки на "В обработке", а затем на "Закрыто" после решения вопроса.
4. Администратор @PythonDEV1 проверяет активность операторов и, при необходимости, изменяет статус пользователя на operator.

---
## Примечания

- Убедитесь, что база данных настроена и доступна по указанному пути.
- Для изменения статуса пользователей требуются права администратора.
- Поддержка дополнительных языков зависит от реализации проверки lang в коде.