<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Панель оператора</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/styles.css">


</head>

<body>
<div class="chat-container">
    <header class="chat-header">
        <div class="header-content">
            <h1>eHukumat</h1>
            <div id="requests-icon" class="requests-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                     stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
                    <polyline points="13 2 13 9 20 9"></polyline>
                </svg>
                <span class="requests-count">3</span>
            </div>
        </div>
        <button id="logout-btn" class="logout-btn">Выход</button>
    </header>
    <div class="chat-box" id="chat-box">
        <div class="message user-message">
            <p>Здравствуйте! У меня вопрос по поводу доставки.</p>
            <span class="timestamp">14:25</span>
        </div>
        <div class="message operator-message">
            <p>Добрый день! Слушаю вас.</p>
            <span class="timestamp">14:26</span>
        </div>
    </div>
    <footer class="chat-footer">
        <input type="text" id="message-input" placeholder="Введите ваше сообщение...">
        <button id="send-button">Отправить</button>
    </footer>
</div>

<div id="requests-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Заявки в ожидании</h2>
            <button class="back-button">&larr; Назад</button>
        </div>
        <div class="requests-list">
            <div class="request-item">
                <div class="request-details">
                    <p><strong>Номер заявки:</strong> #1024</p>
                    <p><strong>ФИО:</strong> Иванов Иван Иванович</p>
                    <p><strong>Телефон:</strong> +7 (999) 123-45-67</p>
                    <p><strong>Вопрос:</strong> Не могу отследить свой заказ.</p>
                    <p><strong>Время:</strong> 14:30 18.06.2025</p>
                </div>
                <button class="accept-btn">Принять</button>
            </div>
            <div class="request-item">
                <div class="request-details">
                    <p><strong>Номер заявки:</strong> #1025</p>
                    <p><strong>ФИО:</strong> Петрова Мария Сергеевна</p>
                    <p><strong>Телефон:</strong> +7 (926) 765-43-21</p>
                    <p><strong>Вопрос:</strong> Как вернуть товар?</p>
                    <p><strong>Время:</strong> 14:32 18.06.2025</p>
                </div>
                <button class="accept-btn">Принять</button>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
    const chatBox = document.getElementById('chat-box');
    const messageInput = document.getElementById('message-input');
    const sendButton = document.getElementById('send-button');
    const logoutBtn = document.getElementById('logout-btn'); // ИЗМЕНЕНО

    // Модальное окно
    const modal = document.getElementById('requests-modal');
    const requestsIcon = document.getElementById('requests-icon');
    // ИЗМЕНЕНО: Ищем все кнопки "Назад"
    const backButtons = document.querySelectorAll('.back-button');

    // ИЗМЕНЕНО: Логика выхода
    logoutBtn.addEventListener('click', () => {
        window.location.href = 'index.html';
    });

    // Отправка сообщения
    sendButton.addEventListener('click', sendMessage);
    messageInput.addEventListener('keypress', function (e) {
        if (e.key === 'Enter') {
            sendMessage();
        }
    });

    function sendMessage() {
        const messageText = messageInput.value.trim();
        if (messageText === '') return;

        const messageElement = document.createElement('div');
        messageElement.classList.add('message', 'operator-message');

        const textElement = document.createElement('p');
        textElement.textContent = messageText;

        const timestampElement = document.createElement('span');
        timestampElement.classList.add('timestamp');
        const now = new Date();
        timestampElement.textContent = `${now.getHours()}:${String(now.getMinutes()).padStart(2, '0')}`;

        messageElement.appendChild(textElement);
        messageElement.appendChild(timestampElement);
        chatBox.appendChild(messageElement);

        chatBox.scrollTop = chatBox.scrollHeight;
        messageInput.value = '';
    }

    // Управление модальным окном
    requestsIcon.addEventListener('click', () => {
        modal.style.display = 'block';
    });

    // ИЗМЕНЕНО: Закрытие модальных окон по кнопке "Назад"
    backButtons.forEach(button => {
        button.addEventListener('click', () => {
            button.closest('.modal').style.display = 'none';
        });
    });

    window.addEventListener('click', (event) => {
        if (event.target == modal) {
            modal.style.display = 'none';
        }
    });

    // Обработка принятия заявок
    document.querySelectorAll('.accept-btn').forEach(button => {
        button.addEventListener('click', (e) => {
            alert('Заявка принята! (демо)');
            e.target.closest('.request-item').remove();
            modal.style.display = 'none';
        });
    });
});

</script>
</body>

</html>